(this.webpackJsonppublic=this.webpackJsonppublic||[]).push([[0],{29:function(e,t,n){},30:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var s=n(0),o=n(21),c=n.n(o),a=(n(29),n(3)),i=n(4),r=n(7),u=n(6),l=n(2),h=new(function(){function e(){Object(a.a)(this,e),this.sessionStorageUser="gochatuser"}return Object(i.a)(e,[{key:"login",value:function(e,t){var n=this.createGuid();sessionStorage.setItem(this.sessionStorageUser,JSON.stringify({_name:e,_userId:n})),t()}},{key:"logout",value:function(e){sessionStorage.removeItem(this.sessionStorageUser),e()}},{key:"isAuthenticated",value:function(){return sessionStorage.getItem(this.sessionStorageUser)}},{key:"getUserName",value:function(){return JSON.parse(sessionStorage.getItem(this.sessionStorageUser))._name}},{key:"getUserId",value:function(){return JSON.parse(sessionStorage.getItem(this.sessionStorageUser))._userId}},{key:"createGuid",value:function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return(e()+e()+"-"+e()+"-4"+e().substr(0,3)+"-"+e()+"-"+e()+e()+e()).toLowerCase()}}]),e}()),j=(n(30),n(1)),d=function(e){Object(r.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"handleLogout",value:function(){var e=this;h.logout((function(){return e.props.history.push("/")}))}},{key:"render",value:function(){var e=this;return Object(j.jsxs)("div",{className:"header",children:[Object(j.jsx)("h2",{children:"Chat App"}),Object(j.jsx)("button",{className:"logout-button",onClick:function(){e.handleLogout()},children:"Logout"})]})}}]),n}(s.Component),b=Object(l.g)(d),m=n(23),f=function(){function e(t,n,s){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object(a.a)(this,e),this._socketEndpoint="".concat(t,"?user=").concat(n,"&userId=").concat(s),this._socket=o?new WebSocket(this._socketEndpoint):null}return Object(i.a)(e,[{key:"createSocket",value:function(){null==this._socket&&(this._socket=new WebSocket(this._socketEndpoint))}},{key:"closeSocket",value:function(){null!=this._socket&&(this._socket.close(),this._socket=null)}},{key:"connect",value:function(e){console.log("Attempting Connection..."),this._socket.onopen=function(){console.log("Successfully Connected")},this._socket.onmessage=function(t){e(t)},this._socket.onclose=function(t){console.log("Socket Closed Connection: ",t),e(t)},this._socket.onerror=function(e){console.log("Socket Error: ",e)}}},{key:"sendMsg",value:function(e,t){console.log("sending msg: ",e);var n={message:e,id:t};this._socket.send(JSON.stringify(n))}}]),e}(),p=(n(37),function(e){Object(r.a)(n,e);var t=Object(u.a)(n);function n(e){var s;Object(a.a)(this,n),s=t.call(this,e);var o=JSON.parse(s.props.message);return s.state={message:o,timeStamp:s.displayTime(o.timeStamp)},s}return Object(i.a)(n,[{key:"render",value:function(){return Object(j.jsxs)("div",{className:"Message",children:[Object(j.jsx)("span",{className:"timeStamp",children:this.state.timeStamp}),Object(j.jsxs)("span",{className:"userName",style:{color:this.state.message.color},children:[this.state.message.user,"\xa0"]}),Object(j.jsx)("span",{className:"messageBody",children:this.state.message.body})]})}},{key:"displayTime",value:function(e){var t=new Date(e).toLocaleString();return"".concat(t.substr(11,4),"\xa0").concat(t.substr(t.length-2,t.length))}}]),n}(s.Component)),O=(n(38),function(e){Object(r.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.scrollToBottom()}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"scrollToBottom",value:function(){this.el.scrollIntoView({behvaior:"smooth"})}},{key:"render",value:function(){var e=this;console.log(this.props.chatHistory);var t=this.props.chatHistory.map((function(e,t){return Object(j.jsx)(p,{message:e.data},t)}));return Object(j.jsx)("div",{className:"ChatHistory",children:Object(j.jsxs)("div",{id:"chatHistory",className:"disable-scrollbars",children:[Object(j.jsx)("div",{id:"history",children:t}),Object(j.jsx)("div",{ref:function(t){e.el=t}})]})})}}]),n}(s.Component)),v=(n(39),function(e){Object(r.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return Object(j.jsx)("div",{className:"ChatInput",children:Object(j.jsx)("input",{onKeyDown:this.props.send})})}}]),n}(s.Component)),g=(n(40),function(e){Object(r.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return Object(j.jsx)("div",{className:"UserList",children:Object(j.jsxs)("div",{className:"user-list",children:[Object(j.jsx)("p",{className:"usersLabel",children:" Users:"}),this.props.userList.map((function(e,t){return Object(j.jsx)("p",{className:"user",style:{color:e.color},children:e.name},t)}))]})})}}]),n}(s.Component)),y=function(e){Object(r.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(a.a)(this,n),(s=t.call(this,e)).handleShow=function(){s.setState({isActive:!0})},s.handleHide=function(){s.setState({isActive:!1})},s.state={isActive:!1,chatHistory:[],userList:[]},s}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;h.isAuthenticated()&&(this._chatSocket=new f("ws://localhost:8080/ws",h.getUserName(),h.getUserId(),!0),this._chatSocket.connect((function(t){e.handleSocketEvent(t)})))}},{key:"componentWillUnmount",value:function(){this._chatSocket.closeSocket()}},{key:"handleSocketEvent",value:function(e){switch(e.type){case"close":this.handleLogout();break;case"message":this.handleMessage(e)}}},{key:"handleLogout",value:function(){var e=this;h.logout((function(){e.props.history.push("/")}))}},{key:"handleMessage",value:function(e){var t=JSON.parse(e.data);switch(t.type){case 0:this.setState({userList:t.clientList});break;case 1:this.setState((function(t){return{chatHistory:[].concat(Object(m.a)(t.chatHistory),[e])}}))}}},{key:"send",value:function(e){13===e.keyCode&&""!==e.target.value&&(this._chatSocket.sendMsg(e.target.value,h.getUserId()),e.target.value="")}},{key:"render",value:function(){var e=this;return h.isAuthenticated?Object(j.jsxs)("div",{className:"ChatPage",children:[Object(j.jsx)(g,{userList:this.state.userList}),Object(j.jsx)(O,{chatHistory:this.state.chatHistory}),Object(j.jsx)(v,{send:function(t){return e.send(t)}})]}):Object(j.jsx)(l.a,{to:"/"})}}]),n}(s.Component),k=n(14),x=(n(41),function(e){Object(r.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(a.a)(this,n),(s=t.call(this,e)).handleChange=function(e){s.setState(Object(k.a)({},e.target.name,e.target.value))},s.submitLogin=function(){h.login(s.state.name,(function(){s.props.history.push("/chat")}))},s.keyPressed=function(e){"Enter"===e.key&&s.submitLogin()},s.state={name:""},s}return Object(i.a)(n,[{key:"render",value:function(){var e=this;return Object(j.jsx)("div",{className:"LoginPage",children:Object(j.jsxs)("div",{className:"loginContainer",onKeyPress:this.keyPressed,children:[Object(j.jsxs)("div",{className:"form__group field",children:[Object(j.jsx)("input",{type:"input",className:"form__field",name:"name",id:"name",value:this.state.name,onChange:function(t){return e.handleChange(t)}}),Object(j.jsx)("label",{htmlFor:"name",className:"form__label",children:"Username"})]}),Object(j.jsx)("button",{className:"login-button",onKeyPress:this.onKeyPress,onClick:this.submitLogin,children:"Login"})]})})}}]),n}(s.Component)),S=n(15),N=n(24),_=["component"],C=function(e){var t=e.component,n=Object(N.a)(e,_);return Object(j.jsx)(l.b,Object(S.a)(Object(S.a)({},n),{},{render:function(e){return h.isAuthenticated()?Object(j.jsx)(t,Object(S.a)({},e)):Object(j.jsx)(l.a,{to:{pathname:"/",state:{from:e.location}}})}}))},w=(n(42),function(e){Object(r.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return Object(j.jsxs)("div",{className:"App",children:[Object(j.jsx)(b,{}),Object(j.jsx)(l.b,{children:Object(j.jsxs)(l.d,{children:[Object(j.jsx)(l.b,{exact:!0,path:"/",component:x}),Object(j.jsx)(C,{exact:!0,path:"/chat",component:y}),Object(j.jsx)(l.b,{path:"*",component:function(){return"404 NOT FOUND"}})]})})]})}}]),n}(s.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var L=n(12);c.a.render(Object(j.jsx)(L.a,{children:Object(j.jsx)(w,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[43,1,2]]]);
//# sourceMappingURL=main.158e30a9.chunk.js.map